//
//  Tools.m
//  iReader
//
//  Copyright © 1998-2017, FEITIAN Technologies Co., Ltd. All rights reserved.
//

#import "Tools.h"
#import "commandModel.h"
#import "SVProgressHUD.h"

@implementation Tools
static Tools *_instance;
+(instancetype)allocWithZone:(struct _NSZone *)zone
{
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        if (_instance == nil) {
            _instance = [super allocWithZone:zone];
        }
    });
    return _instance;
}

+(instancetype)shareTools
{
    return [[self alloc]init];
}

-(id)copyWithZone:(NSZone *)zone
{
    return _instance;
}
-(id)mutableCopyWithZone:(NSZone *)zone
{
    return _instance;
}

-(void)showMsg:(NSString *)msg
{
    dispatch_async(dispatch_get_main_queue(), ^{
        [SVProgressHUD showWithStatus:msg maskType:SVProgressHUDMaskTypeBlack];
    });
}

-(void)hideMsgView
{
    dispatch_async(dispatch_get_main_queue(), ^{
        [SVProgressHUD dismiss];
    });
}

-(void)showError:(NSString *)error
{
    dispatch_async(dispatch_get_main_queue(), ^{
        [SVProgressHUD showErrorWithStatus:error maskType:SVProgressHUDMaskTypeBlack];
    });
}

-(BOOL)getHexDataFormString:(NSString *)text withBuf:(unsigned char *)pbuf
                     AndLen:(unsigned int *)pLen
{
    
    unsigned  int capdulen;
    unsigned char capdu[512];
    
    NSString* tempBuf = [NSString string];
    
    if([text length] < 2 ) {
        
        *pLen = 0;
        return TRUE;
    }
    
    tempBuf = text;
    
    //  NSString* comand = [tempBuf stringByAppendingString:@"\n"];
    const char *buf = [tempBuf UTF8String];
    NSMutableData *data = [NSMutableData data];
    uint32_t len = strlen(buf);
    
    //to hex
    char singleNumberString[3] = {'\0', '\0', '\0'};
    uint32_t singleNumber = 0;
    for(uint32_t i = 0 ; i < len; i+=2) {
        if ( ((i+1) < len) && isxdigit(buf[i]) && (isxdigit(buf[i+1])) ) {
            singleNumberString[0] = buf[i];
            singleNumberString[1] = buf[i + 1];
            sscanf(singleNumberString, "%x", &singleNumber);
            uint8_t tmp = (uint8_t)(singleNumber & 0x000000FF);
            [data appendBytes:(void *)(&tmp) length:1];
        } else {
            break;
        }
    }
    
    [data getBytes:capdu];
    capdulen = [data length];
    
    if (*pLen < capdulen ) {
        return FALSE;
    }
    *pLen = capdulen;
    memcpy(pbuf, capdu, *pLen);
    return TRUE;
    
}

-(NSString *)getStringFormHexData:(unsigned char *)buf withLen:( int )len
{
    NSMutableData *tmpData = [NSMutableData data];
    [tmpData appendBytes:buf length:len];
    
    NSString* dataString= [NSString stringWithFormat:@"%@",tmpData];
    NSRange begin = [dataString rangeOfString:@"<"];
    NSRange end = [dataString rangeOfString:@">"];
    NSRange range = NSMakeRange(begin.location + begin.length, end.location- begin.location - 1);
    dataString = [dataString substringWithRange:range];
    
    return dataString;
    
}

-(NSData *)readFileContent:(NSString *)fileName
{
//    NSData* fileData = nil;
//    NSArray *directoryPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
//    NSString *docmentDirectory = [directoryPaths objectAtIndex:0];
//    NSString *filePath = [docmentDirectory stringByAppendingPathComponent:fileName];
//
//    fileData = [[NSData alloc] initWithContentsOfFile:filePath];
//    NSString *srcString = [[NSString alloc] initWithData:fileData  encoding:NSUTF8StringEncoding];;
//    NSString *desString = [srcString stringByReplacingOccurrencesOfString:@"\r\n" withString:@""];
//    fileData = [desString dataUsingEncoding:NSUTF8StringEncoding];
    
    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"flash.txt" ofType:nil];
    
    NSData *fileData = [[NSData alloc] initWithContentsOfFile:filePath];
    NSString *srcString = [[NSString alloc] initWithData:fileData  encoding:NSUTF8StringEncoding];;
    NSString *desString = [srcString stringByReplacingOccurrencesOfString:@"\r\n" withString:@""];
    fileData = [desString dataUsingEncoding:NSUTF8StringEncoding];
    return fileData;
}

-(NSArray *)commandArray
{
    commandModel *model2 = [commandModel commandModelWithName:@"writeFlash" image:@"WriteFlash"];
    commandModel *model3 = [commandModel commandModelWithName:@"readFlash" image:@"ReadFlash"];
    commandModel *model1 = [commandModel commandModelWithName:@"readUID" image:@"UID"];
    
    return @[model1, model2 ,model3];
}

-(NSArray *)apduArray
{
    return
    @[
        @"0084000008",
          @"0084000008",
          @"FFCA000000",
          @"00B00000FF",
          @"00A40000023F00",
#if 0
      @"002241b6050480018482",
      @"0020000108241234ffffffffff",
      @"002a9e9a533051300d060960864801650304020305000440db8fa6e2b208c9ba444ab54216cb0cf06558bb9e6502 1f6d887eb904e1acd852df9891653bf8774c04f0338e2150b99b1f2be4edfbdf56ea9812ea1ac7f27191",

      //test Germany e-Health card
      @"00A4040C06D27600000102",
      @"00B08100C0", //the limit 0xC0 for the answer works here (but there are more than just 0xC0 bytes)
      @"00B08100C1", //the limit 0xC1 fails for FW. v4.31 but works for v.2.41
      @"00B08100000000", //reading without limit fails for FW. v4.31 but works for v.2.41
 @"0C2A00BE00015F8782015101A277BF9041C8FA1E961F0A73DCCEECC37DFD2F9ED6F03EF4C99D05DAB54D389C4BC3BA0052C060B14F9E958629C395EECFE3B329894B920F8ECF5CE7159B610F0231AF4A1AC6688F3D7218BAD8FE42F72394DF1E58D38C76CD16D445F34654561CDBA86FBAC1B6E8058D344B42B301D7751F0F8214CFB115DA824B574720F62C2929716559817EF0745AC84DFD19EB7433CE292363E03B5826C3E3DF2E8851A20B494AB55DB2A0BC89FCBCEE10AFD16C81B3F4E8BCCA0BB29946C8BFC884A08279497D166E0486FB43DCC3C3092F81C4EE4E419F00F72C3E4C24BBAAB244D16AD3B30816502E6008852ABF73F8F580B11817AEB29CEC38C1571D7E3CA7865494C986F91B4C8C146B76F63BD0F8A81F22F3E2875D84CD17A62B98BFE0EC449F2E718079B7507C94B5946BF803F0B43BEFD376A99FF89E6EC0F77C3917028FEEAA69A0ABD8F109DED491C02073A9BAA9638E0892520F9D3BCE85D00000",
      
    @"0084000008",
    @"java card command as follow:",
    @"008400007F",
    @"00A4040008D156000001010301",
    @"00A40000023F00",
    @"00e4010002a001",
    @"00e00000186216820238008302a00185020000860800000000000000ff",
    @"00A4000002A001",
    @"00E00000186216820201018302B001850200ff86080000000000000000",
    @"00D60000FA00010203040506070809101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798990001020304050607080910111213141516171819202122232425262728293031323334353637383940414243444546474849",
    @"00D60000FB0001020304050607080910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989900010203040506070809101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950",
    @"00D60000FF000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798990001020304050607080910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989900010203040506070809101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354",
    @"00b00000FF",
    @"00A40000023F00",
    @"00A4000002A001",
    @"00e4020002B001",
    @"00A40000023F00",
    @"00e4010002a001",
    @"ben_262 card as follow",
    @"00a404000a01020304050607080900",
    @"8010010600",
    @"8020000001",
    
    @"80300000FB0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    @"80300000FA00010203040506070809101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798990001020304050607080910111213141516171819202122232425262728293031323334353637383940414243444546474849",
    @"80300000010600010203040506070809101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899000102030405060708091011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798990001020304050607080910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061",
    @"8010010600",
    @"black-white type B",
    @"00A404000BA000000291A00000019102",
    @"00B201A420",
    @"00B201AC40",
    @"好的之扩展指令select app, write 128,read,write 250,read,write 256,read",
    @"00A40400051122334455",
    @"128bytes",
    @"0001000080f22b672d5c76a1653d7ed0478fdcf7542334f77a7b0c108b74dea5ee276b3f951253d52e73e34b9ef52e38ab8e5fecf8a84db2377f50529aca54da8a9d2b9e9c8e287ec117e967bd3b741dda6c8637ddad276b39f4820b83d2f4d0265563d7582ed1e94c0f408521da0025d613a006bf3b33946c465b89677c74edb81635f5c3",
    @"00020000",
    @"250bytes",
    @"00010000FAf22b672d5c76a1653d7ed0478fdcf7542334f77a7b0c108b74dea5ee276b3f951253d52e73e34b9ef52e38ab8e5fecf8a84db2377f50529aca54da8a9d2b9e9c8e287ec117e967bd3b741dda6c8637ddad276b39f4820b83d2f4d0265563d7582ed1e94c0f408521da0025d613a006bf3b33946c465b89677c74edb81635f5c3f22b672d5c76a1653d7ed0478fdcf7542334f77a7b0c108b74dea5ee276b3f951253d52e73e34b9ef52e38ab8e5fecf8a84db2377f50529aca54da8a9d2b9e9c8e287ec117e967bd3b741dda6c8637ddad276b39f4820b83d2f4d0265563d7582ed1e94c0f408521da0025d613a006bf3b33946c465b89677c74",
    @"00020000",
    @"256bytes",
    @"00010000000100016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395",
    @"00020000",
    @"262bytes",
    @"00010000000106016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395112233445566",
    @"00020000",
    @"300bytes",
    @"0001000000012Cff001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899001122334455667788990011223344556677889900112233445566778899",
    @"00020000",
    @"512bytes",
    @"00010000000200016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395",
    @"00020000",
    @"1024bytes",
    @"00010000000400016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395",
    @"00020000",
    @"2048bytes",
    @"00010000000800016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395016e0967bfaead620f0c246db4a52a20e8777f2d4d24a78fd9929d1aa7e556501f774008537b375bbf2e66834b5138897e41dbb73ab9f171d825f8304f7788ba0a7f3d45fc005d8d702077afcb8ff72cb98893ca6e51ddb01ba84036bb135083c508530bb1b1d85bccfb228e5486a6aec305e966dc535e594cb68abb7e8725f9f0f49c38fef69c79ff92943d9f2a231c15762993f186ac19361141b3a60fabdb59b6ef8492efef60edcc63adca215771e96b9fcc9d777fbf588af57f74eafcf3f69b3824dbb54629ac6bc5cc3f27ca197dcfdfaaa31946cbb5a09028791521071d558f5168edce7d13ec54c5c5995a5d253fe3ea8ce37c4d6d5e388332495395",
    @"00020000",
    @"好的之com",
    @"00A40400050102030405" ,
    @"8010007000" ,
    @"8010012100",
    @"好的之长返回",
    @"00A404000A01020304050607080900",
    @"80200000EE" ,
    @"80200000EF" ,
    @"80200000F0" ,
    @"80200000F1" ,
    @"80200000FE" ,
    @"80200000FF" ,
    @"801000e3000000",
    @"802000000003e3",
    @"801000f100",
    @"好的之超时0--0x40",
    @"00A404000A01020304050607081000",
    @"8010000000" ,
    @"8010000100" ,
    @"8010000200" ,
    @"8010000300" ,
    @"8010004000" ,
    @"Mifare 1k card",
    @"FF82000106FFFFFFFFFFFF" ,
    @"FF860000050100016000" ,
    @"FFB0000210" ,
    @"FFD600021011223344556677889900AABBCCDDEEFF" ,
    @"FFD600021001000000FEFFFFFF0100000001FE01FE" ,
    @"压力测试卡",
    @"007700000004005198ACAA3574C9815E246CBA92328EB4BE9DB925D26A78BCD25B0D052AFF618C43EB41455346C62B798B1528098A493525B0AEC28D893058B783137D23F5E4D8E95FAF9594F4720B3255D29CACA00DDD54A930F7BD878A4ECF5360601A2CE2EF6B7E5E629D84B469B20C0AE0237BC0F67310A68E0A6D6DE541535C75BAAD441AF2D0B6741901738C213724BA15234CC6AC6E7A4D1E42C366360B6F86A87FF3A1A6DC2092AE7099BDA65F8AF32AA19796254A13FD9E0E7319D50402598FAAD6CCAE2A028604DB0D44690BA3530BFC8BAD062CD96635D9654647C57BB81537D4E23242C516C449B76993C3D7A1603C0F55789C344F89AC8135B3D64469E22DD72D5CADD20B96C37F744C108EA7D06A0AD4A3238C81428EAF2E42C0C3349F94C6F352F2902C21504DACBB78302B048C6673AE4849C50988D7781C0A62E3F474887D3C9966430EF8095A098525F6A4AD0A7AC194D3E186A1E15C683C883C88D60713432ABE1604C39BC65DBFD6D057D2DE31068E939D60E1B5224FDF9C0904C12AFD8F2EFF6FACBAEB38E0ADA980C505CADFA2BEEFC33F503B12F87A08100F3ED982472D9014AEE4E2F8BAD707D0974DB6CEC0AC5019CDF75C738B95331A5254FCEB93ADDBCDB14A664D12C5598675B38A4486E11F69AFDDFE8F32B885EE750B7C809C3847645DF260811000056B063D2E8A1CE4C279900A0AAC136C66561F6B3F898A553C9F5CE6B9DADE0F7547F3F58AE8AB3DA3111687691356383E18F87D2E4E858D2248532E57A1A17A0FE2E3E387A55B7528FBE95B010C24A575FDA9483117B4666225EDD0241D84CA3D037F0E0B0B5313BBFEB28EBCDEA53A73CDDAD4312B3F6A62FFD0D60798AC8666746F7EFF60BC9FC3E1192981D3007FA150322A14D34F218B9DA447E7584436F1FB5A3B4CEDBDA1A86DC53337315EFC654D5A51C4570C1245C9122CAEA672624861E94ED8FA7FA2D16A5FB4C841E63A288EFA5127FF9DC5F949C18C43CA5E93D26DC3BE8DCF2A2AA8A08EB51B4BC1C053D9B93327122AC20DE65B6F8E0C3250F7E9909352B3E5BF94D6FB3C189716164CF73FFEABDADD92EB6885DE77B413221F9BFAD50EF0D8EBFDD64E54A76C0EC57DB035BA9A9DDCBCF997E9DFE6092B90B24DA78DABCC2C354B662E02B014D1544CCB4370DEA44FC8A13B2F7DC354A22218C53FC310900925E74F43501BD5864B231210275E375F3E4A1BFFBDF6DDA060BACC6B7D2583964437583645D0F85533694B45E7029E33A75B00FFA967EC4CD3FE29D3C5D2EFFC19A44BAFE9B8C46792863F89B8B220F58B3EB2DA48FFC9CE024DA61EA2FF1A622D97EF5545B983E4F3E2B685A35606CA705AF936A2A4BC4F751009F41D944DF106760BD160BC7BF4DBE578E1AFD699DCE0179DBCC03F0CF7B5AD1BFF3C79D0D12EAA68CA43AAF6BDD4F74C44E51A1E",
#endif
    ];
}

-(NSString *)mapErrorCode:(LONG)ret {
    
    NSString *info = @"success";
    
    switch (ret) {
        case SCARD_E_INVALID_HANDLE:
            info = [NSString stringWithFormat:@"0x%08x:The supplied handle was invalid.", ret];
            break;
            
        case SCARD_E_INVALID_PARAMETER:
            info = [NSString stringWithFormat:@"0x%08x:One or more of the supplied parameters could not be properly interpreted.", ret];
            break;
            
        case SCARD_E_INSUFFICIENT_BUFFER:
            info = [NSString stringWithFormat:@"0x%08x:The data buffer to receive returned data is too small for the returned data.", ret];
            break;
            
        case SCARD_E_TIMEOUT:
            info = [NSString stringWithFormat:@"0x%08x:The user-specified timeout value has expired. ", ret];
            break;
            
        case SCARD_E_NO_SMARTCARD:
            info = [NSString stringWithFormat:@"0x%08x:The operation requires a Smart Card, but no Smart Card is currently in the device.", ret];
            break;
            
        case SCARD_E_INVALID_VALUE:
            info = [NSString stringWithFormat:@"0x%08x:One or more of the supplied parameters values could not be properly interpreted.", ret];
            break;
            
        case SCARD_F_COMM_ERROR:
            info = [NSString stringWithFormat:@"0x%08x:An internal communications error has been detected.", ret];
            break;
            
        case SCARD_E_NOT_TRANSACTED:
            info = [NSString stringWithFormat:@"0x%08x:An attempt was made to end a non-existent transaction.", ret];
            break;
            
        case SCARD_E_READER_UNAVAILABLE:
            info = [NSString stringWithFormat:@"0x%08x:The specified reader is not currently available for use.", ret];
            break;
            
        case SCARD_E_READER_UNSUPPORTED:
            info = [NSString stringWithFormat:@"0x%08x:The reader driver does not meet minimal requirements for support.", ret];
            break;
            
        case SCARD_E_CARD_UNSUPPORTED:
            info = [NSString stringWithFormat:@"0x%08x:The smart card does not meet minimal requirements for support.", ret];
            break;
            
        default:
            info = [NSString stringWithFormat:@"0x%08x:Unknown error", ret];
            break;
    }
    
    return info;
}

-(BOOL)iPhonexSerial
{
    CGFloat height = [UIScreen mainScreen].bounds.size.height;
    
    if (height == 812 || height == 896) {
        return YES;
    }
    return NO;
}

@end
